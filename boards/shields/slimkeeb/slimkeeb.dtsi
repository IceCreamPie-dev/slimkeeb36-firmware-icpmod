/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <dt-bindings/zmk/matrix_transform.h>

/ {
    chosen {
        zmk,physical-layout = &physical_layout0;
    };

    /* ZMK Studio 물리 속성 바인딩 (7개 인자) */
    key_physical_attrs: key_physical_attrs {
        compatible = "zmk,key-physical-attrs";
        #key-cells = <7>; /* x, y, w, h, rx, ry, rz */
    };

    default_transform: keymap_transform_0 {
        compatible = "zmk,matrix-transform";
        columns = <8>;
        rows = <5>;
        map = <
            RC(0,0) RC(0,1) RC(0,2) RC(1,2) RC(0,3)   RC(0,7) RC(1,6) RC(0,6) RC(0,5) RC(0,4)
            RC(1,0) RC(3,0) RC(3,1) RC(3,2) RC(1,3)   RC(1,7) RC(3,6) RC(3,5) RC(3,4) RC(1,4)
            RC(2,0) RC(1,1) RC(2,1) RC(2,2) RC(2,3)   RC(2,7) RC(2,6) RC(2,5) RC(1,5) RC(2,4)
                            RC(4,2) RC(4,1) RC(4,0)   RC(4,4) RC(4,5) RC(4,6)
        >;
    };

    layouts {
        compatible = "zmk,physical-layout-list";

        physical_layout0: physical_layout_0 {
            compatible = "zmk,physical-layout";
            display-name = "Corne 36 (Correct Scale)";
            transform = <&default_transform>;
            
            /* * [수정됨] 단위: 100 = 1u (centi-keyunit)
             * 이전 코드의 1/19 크기로 정상화했습니다.
             * 키 크기: 100x100 (1u)
             * 코르네 특유의 높낮이(Column Stagger) 적용
             */
            keys = 
                /* --- Left Hand (Top Row) --- */
                /* X    Y   W   H   rot rx ry */
                <&key_physical_attrs   0   50  100 100  0  0  0>, /* Pinky */
                <&key_physical_attrs 100   12  100 100  0  0  0>, /* Ring */
                <&key_physical_attrs 200    0  100 100  0  0  0>, /* Middle (Highest) */
                <&key_physical_attrs 300   12  100 100  0  0  0>, /* Index */
                <&key_physical_attrs 400   12  100 100  0  0  0>, /* Inner */

                /* --- Right Hand (Top Row) --- */
                /* Gap: 2u (X좌표 600부터 시작) */
                <&key_physical_attrs 600   12  100 100  0  0  0>,
                <&key_physical_attrs 700   12  100 100  0  0  0>,
                <&key_physical_attrs 800    0  100 100  0  0  0>,
                <&key_physical_attrs 900   12  100 100  0  0  0>,
                <&key_physical_attrs 1000  50  100 100  0  0  0>,

                /* --- Left Hand (Middle Row) --- */
                <&key_physical_attrs   0  150  100 100  0  0  0>,
                <&key_physical_attrs 100  112  100 100  0  0  0>,
                <&key_physical_attrs 200  100  100 100  0  0  0>,
                <&key_physical_attrs 300  112  100 100  0  0  0>,
                <&key_physical_attrs 400  112  100 100  0  0  0>,

                /* --- Right Hand (Middle Row) --- */
                <&key_physical_attrs 600  112  100 100  0  0  0>,
                <&key_physical_attrs 700  112  100 100  0  0  0>,
                <&key_physical_attrs 800  100  100 100  0  0  0>,
                <&key_physical_attrs 900  112  100 100  0  0  0>,
                <&key_physical_attrs 1000 150  100 100  0  0  0>,

                /* --- Left Hand (Bottom Row) --- */
                <&key_physical_attrs   0  250  100 100  0  0  0>,
                <&key_physical_attrs 100  212  100 100  0  0  0>,
                <&key_physical_attrs 200  200  100 100  0  0  0>,
                <&key_physical_attrs 300  212  100 100  0  0  0>,
                <&key_physical_attrs 400  212  100 100  0  0  0>,

                /* --- Right Hand (Bottom Row) --- */
                <&key_physical_attrs 600  212  100 100  0  0  0>,
                <&key_physical_attrs 700  212  100 100  0  0  0>,
                <&key_physical_attrs 800  200  100 100  0  0  0>,
                <&key_physical_attrs 900  212  100 100  0  0  0>,
                <&key_physical_attrs 1000 250  100 100  0  0  0>,

                /* --- Left Thumb Cluster --- */
                <&key_physical_attrs 200  325  100 100  0  0  0>,
                <&key_physical_attrs 300  335  100 100  0  0  0>,
                <&key_physical_attrs 400  335  100 100  0  0  0>,

                /* --- Right Thumb Cluster --- */
                <&key_physical_attrs 600  335  100 100  0  0  0>,
                <&key_physical_attrs 700  335  100 100  0  0  0>,
                <&key_physical_attrs 800  325  100 100  0  0  0>;
        };
    };
};

&uicr {
    nfct-pins-as-gpios;
};
